---
title: 矩阵求导
date: 2018-06-18 23:40:12
categories:
- math
tags:
- basis
- 线性代数
- 矩阵
- 求导
- math
---
[文章来源](http://xuehy.github.io/blog/2014/04/18/2014-04-18-matrixcalc/index.html)

<!-- more -->

## 引言

矩阵求导，想必许多领域能见到。统计学，经济学，优化，机器学习等等，在对目标问题建立数学模型之后，问题往往被抽象为关于矩阵的优化问题。于是免不了需要对矩阵进行求导等操作。

简单的向量和矩阵求导，大多数熟悉这些计算的人，应该都能直接写下，然而复杂的矩阵函数求导则没那么简单，著名的matrix cookbook为广大的研究者们提供了一本大字典，里面有着各种简单到复杂矩阵和向量的求导法则，但是如果你的好奇心和我一样重，那么你肯定不会满足于查字典这种方法，特别是在推导公式一气呵成满纸乱飞的时候，查字典岂不是大煞风景？

事实上，所有求导的法则都可以从最基本的求导规则推导出来。不知你有没发现，不同的文献中，同样的式子求导的结果有时候会不一样，仔细观察会发现刚好相差一个转置，于是我们得先说说求导的两个派别（布局）。

## 布局(Layout)

不知道为什么会是这个名字，总之矩阵求导有两种布局，分子布局(numerator layout)和分母布局(denominator layout)。

为了阐明这两种布局的区别，我们先来看最简单的求导规则。

首先是向量 y 对标量 x 求导，我们假定所有的向量都是列向量，

![](/images/math/5_0.JPG)

在分子布局下，

![](/images/math/5_1.JPG)

而在分母布局下，

![](/images/math/5_2.JPG)

你可以随时在两种布局间进行转换，只要你自己不犯迷糊。为了简单起见，更为了遵循大多数时候的传统，我在接下来的部分将默认使用分母布局，除非是在一些很特殊的情形，这些我们到时候再详述。

好了我们这就开始，为了继续下面的旅程，请忘掉分子布局，直到我提醒你为止。下面全都基于分母布局!

## 基本的求导规则（定义）

这一部分，我们将看到一些基本的求导规则，这些与其说是规则，倒不如说是定义。因此这一部分是需要好好理解并且记忆（如果你看一遍还记不住的话）的。

标量 y 对向量 x 求导:

![](/images/math/5_3.JPG)

注意到，标量对向量求导和向量对标量求导刚好反过来。

向量对向量求导，

![](/images/math/5_4.JPG)

标量对矩阵求导，

![](/images/math/5_5.JPG)

矩阵对标量求导，

![](/images/math/5_6.JPG)

事实上，直观上看，凡是对标量求导，结果的形式都要转置，而标量对向量和矩阵求导则位置保持不动。这样总结方便我们记忆。

总的来说，涉及矩阵和向量的求导不外乎五大类别，

	向量对标量
	标量对向量
	向量对向量
	矩阵对标量
	标量对矩阵
	
这些定义我在上面都已经一一列出。接下来是时候去看一些更加复杂的东西了。

## 维度分析

接下来我们来看一些常见的求导，

![](/images/math/5_7.JPG)

理论上对于任意的表达式，我们都可以通过定义出发，利用上面这种形式推导得到。

但是对于一些复杂的求导，这个时候恐怕逐项展开分析就不是很靠谱了。

我们先来看求导分类的前三类，对于这三类问题，我们来看一个非常强大的方法，通过分析维度来得到结果。

![](/images/math/5_8.JPG)

我们发现，虽然乘积法则的精准形式无法应用于矩阵求导中，然而这种非精确的乘积法则可以准确的告诉我们哪些项一定会出现在结果中，然后通过分析维度，我们就可以写出结果。

![](/images/math/5_9.JPG)

![](/images/math/5_10.JPG)

![](/images/math/5_11.JPG)

## 标量对矩阵求导（微分形式）

接下来看五种类型中剩下的两类，在实际的问题中，主要是矩阵的迹对矩阵的求导问题。 正如我们在前面看到的，在矩阵的求导中，不存在精确的乘积法则，我们只是通过非精确的乘积法则分析出单项式中含有的项，再通过维度分析得到结果。 但是，有一种情形下，乘积法则是精确成立的，我们现在就来看这一种情形——迹的微分。因为在微分形式下，

	乘积法则成立
	迹和微分可交换

好了，现在你应该已经忘记分子布局了吧，不过不要紧，所有之前的结果转置一下，就得到了分子布局下的结果。

接下来请注意，当我们谈论微分的时候，只有在分子布局下才是有意义的。

（Warning：微分只有分子布局，没有分母布局）

首先我们指出

![](/images/math/5_12.JPG)

![](/images/math/5_13.JPG)

其实很简单，我们再看几个例子来加深理解：

先回忆一些非常有用的迹的性质：

	矩阵的迹和转置的迹相同（转置性质）
	矩阵乘积的迹和矩阵乘积轮换对称后的迹相同（循环排列）

考虑

![](/images/math/5_14.JPG)

这是一份简短的矩阵求导介绍，它的目的是告诉你如何更好的快速推导这些公式，避免查阅手册的麻烦。当然如果你觉得你完全是一个工程师，查阅手册感觉很方便，那么继续按照你的方式生活吧。如果你觉得很有用，那么请继续： Have fun with math!


